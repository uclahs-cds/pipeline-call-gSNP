<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1113px" preserveAspectRatio="none" style="width:643px;height:1113px;background:#FFFFFF;" version="1.1" viewBox="0 0 643 1113" width="643px" zoomAndPan="magnify"><defs/><g><ellipse cx="321" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><polygon fill="#F1F1F1" points="272,50,370,50,382,62,370,74,272,74,260,62,272,50" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="272" y="65.8081">Explicit intervals?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="239" y="59.4058">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="382" y="59.4058">No</text><rect fill="#F1F1F1" height="102.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="217" x="96.5" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="106.5" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="313.5" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="106.5" y="131.4355">Split reference genome into up</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="13" x="106.5" y="145.4043">to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="123.5" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="224.5" y="145.4043">interval lists,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="106.5" y="159.373">without subdividing any of the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="89" x="106.5" y="173.3418">input intervals</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="333.5" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="343.5" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="540.5" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="343.5" y="131.4355">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="343.5" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="444.5" y="145.4043">interval lists</text><line style="stroke:#181818;stroke-width:1.5;" x1="171" x2="495" y1="224.1719" y2="224.1719"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="41" y="244.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="240" x="51" y="267.167">run_HaplotypeCallerVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="41" x2="301" y1="275.4688" y2="275.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="51" y="291.6074">Generate VCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="51" y="305.5762">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="256" x="43" y="338.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="213" x="53" y="361.4014">run_MergeVcfs_Picard_VCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="299" y1="369.7031" y2="369.7031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="236" x="53" y="385.8418">Merge raw variants into whole VCF file</text><polygon fill="#98FB98" points="59.5,418.6719,282.5,418.6719,292.5,435.6563,282.5,452.6406,59.5,452.6406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="69.5" y="439.8105">Per-sample raw VCF + index files</text><rect fill="none" height="408.3281" style="stroke:#000000;stroke-width:1.5;" width="320" x="11" y="462.6406"/><path d="M157,462.6406 L157,471.9375 L147,481.9375 L11,481.9375 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="14" y="476.6357">Recalibrate Variants</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="21" y="498.9375"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="267" x="31" y="521.9326">run_VariantRecalibratorSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="21" x2="321" y1="530.2344" y2="530.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="280" x="31" y="546.373">Generate Variant Quality Score Recalibration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="31" y="560.3418">(VQSR) table for SNPs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="56" y="608.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="66" y="631.167">run_ApplyVQSR_GATK_SNP</text><line style="stroke:#181818;stroke-width:1.0;" x1="56" x2="286" y1="639.4688" y2="639.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="66" y="655.6074">Filter SNPs based on VQSR table</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="21" y="703.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="280" x="31" y="726.4326">run_VariantRecalibratorINDEL_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="21" x2="321" y1="734.7344" y2="734.7344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="199" x="31" y="750.873">Generate VQSR table for INDELs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="243" x="49.5" y="798.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="223" x="59.5" y="821.6982">run_ApplyVQSR_GATK_INDEL</text><line style="stroke:#181818;stroke-width:1.0;" x1="49.5" x2="292.5" y1="830" y2="830"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="59.5" y="846.1387">Filter INDELs based on VQSR table</text><polygon fill="#98FB98" points="75,890.9688,267,890.9688,277,914.9375,267,938.9063,75,938.9063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="172" x="85" y="912.1074">SNP and INDEL recalibrated</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="85" y="926.0762">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="67.5" y="958.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="77.5" y="981.9014">filter_gSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="274.5" y1="990.2031" y2="990.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="77.5" y="1006.3418">Filter ambiguous variants with</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="137" x="77.5" y="1020.3105">customized Perl script</text><polygon fill="#98FB98" points="96,1053.1406,246,1053.1406,256,1077.1094,246,1101.0781,96,1101.0781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="106" y="1074.2793">Filtered germline</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="106" y="1088.248">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="359" y="552.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="252" x="369" y="575.3857">run_HaplotypeCallerGVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="631" y1="583.6875" y2="583.6875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="238" x="369" y="599.8262">Generate GVCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="369" y="613.7949">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="265" x="362.5" y="661.625"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="225" x="372.5" y="684.6201">run_MergeVcfs_Picard_GVCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="362.5" x2="627.5" y1="692.9219" y2="692.9219"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="372.5" y="709.0605">Merge raw variants into whole GVCF file</text><polygon fill="#98FB98" points="392,756.8906,598,756.8906,608,773.875,598,790.8594,392,790.8594" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="402" y="778.0293">Per-sample GVCF + index files</text><line style="stroke:#181818;stroke-width:1.0;" x1="260" x2="205" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="205" x2="205" y1="62" y2="84"/><polygon fill="#181818" points="201,74,205,84,209,74,205,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="382" x2="437" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="437" x2="437" y1="62" y2="84"/><polygon fill="#181818" points="433,74,437,84,441,74,437,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="205" x2="205" y1="186.1719" y2="204.1719"/><polygon fill="#181818" points="201,194.1719,205,204.1719,209,194.1719,205,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="437" x2="437" y1="158.2344" y2="204.1719"/><polygon fill="#181818" points="433,194.1719,437,204.1719,441,194.1719,437,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="205" x2="437" y1="204.1719" y2="204.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="321" x2="321" y1="30" y2="50"/><polygon fill="#181818" points="317,40,321,50,325,40,321,44" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="318.4063" y2="338.4063"/><polygon fill="#181818" points="167,328.4063,171,338.4063,175,328.4063,171,332.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="398.6719" y2="418.6719"/><polygon fill="#181818" points="167,408.6719,171,418.6719,175,408.6719,171,412.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="573.1719" y2="608.1719"/><polygon fill="#181818" points="167,598.1719,171,608.1719,175,598.1719,171,602.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="668.4375" y2="703.4375"/><polygon fill="#181818" points="167,693.4375,171,703.4375,175,693.4375,171,697.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="763.7031" y2="798.7031"/><polygon fill="#181818" points="167,788.7031,171,798.7031,175,788.7031,171,792.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="452.6406" y2="498.9375"/><polygon fill="#181818" points="167,488.9375,171,498.9375,175,488.9375,171,492.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="858.9688" y2="890.9688"/><polygon fill="#181818" points="167,880.9688,171,890.9688,175,880.9688,171,884.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="938.9063" y2="958.9063"/><polygon fill="#181818" points="167,948.9063,171,958.9063,175,948.9063,171,952.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="1033.1406" y2="1053.1406"/><polygon fill="#181818" points="167,1043.1406,171,1053.1406,175,1043.1406,171,1047.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="495" x2="495" y1="626.625" y2="661.625"/><polygon fill="#181818" points="491,651.625,495,661.625,499,651.625,495,655.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="495" x2="495" y1="721.8906" y2="756.8906"/><polygon fill="#181818" points="491,746.8906,495,756.8906,499,746.8906,495,750.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="171" x2="171" y1="225.6719" y2="244.1719"/><polygon fill="#181818" points="167,234.1719,171,244.1719,175,234.1719,171,238.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="495" x2="495" y1="225.6719" y2="552.3906"/><polygon fill="#181818" points="491,542.3906,495,552.3906,499,542.3906,495,546.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="321" x2="321" y1="204.1719" y2="224.1719"/><polygon fill="#181818" points="317,214.1719,321,224.1719,325,214.1719,321,218.1719" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[7193697de8c9fd037c2cfd0c177de89c]
@startuml

skinparam ConditionEndStyle hline

start

if (Explicit intervals?) is (Yes) then
    :==run_SplitIntervals_GATK
    - - - -
    Split reference genome into up
    to **scatter_count** interval lists,
    without subdividing any of the
    input intervals;
else (No)
    :==run_SplitIntervals_GATK
    - - - -
    Split reference genome into
    **scatter_count** interval lists;
endif

split

:==run_HaplotypeCallerVCF_GATK
- - - -
Generate VCFs for each split interval
using HaplotypeCaller;

:==run_MergeVcfs_Picard_VCF
- - - -
Merge raw variants into whole VCF file;

#palegreen:Per-sample raw VCF + index files>

partition "Recalibrate Variants" {

:==run_VariantRecalibratorSNP_GATK
- - - -
Generate Variant Quality Score Recalibration
(VQSR) table for SNPs;

:==run_ApplyVQSR_GATK_SNP
- - - -
Filter SNPs based on VQSR table;

:==run_VariantRecalibratorINDEL_GATK
- - - -
Generate VQSR table for INDELs;

:==run_ApplyVQSR_GATK_INDEL
- - - -
Filter INDELs based on VQSR table;

}

#palegreen:SNP and INDEL recalibrated
variants + index files>

:==filter_gSNP_GATK
- - - -
Filter ambiguous variants with
customized Perl script;

#palegreen:Filtered germline
variants + index files>

detach

split again

:==run_HaplotypeCallerGVCF_GATK
- - - -
Generate GVCFs for each split interval
using HaplotypeCaller;

:==run_MergeVcfs_Picard_GVCF
- - - -
Merge raw variants into whole GVCF file;

#palegreen:Per-sample GVCF + index files>

detach

endsplit


@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>