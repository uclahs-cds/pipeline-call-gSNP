<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1197px" preserveAspectRatio="none" style="width:1001px;height:1197px;background:#FFFFFF;" version="1.1" viewBox="0 0 1001 1197" width="1001px" zoomAndPan="magnify"><defs/><g><ellipse cx="507.5" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><polygon fill="#F1F1F1" points="458.5,50,556.5,50,568.5,62,556.5,74,458.5,74,446.5,62,458.5,50" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="458.5" y="65.8081">Explicit intervals?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="425.5" y="59.4058">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="568.5" y="59.4058">No</text><rect fill="#F1F1F1" height="102.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="217" x="283" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="293" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="283" x2="500" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="293" y="131.4355">Split reference genome into up</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="13" x="293" y="145.4043">to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="310" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="411" y="145.4043">interval lists,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="293" y="159.373">without subdividing any of the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="89" x="293" y="173.3418">input intervals</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="520" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="530" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="520" x2="727" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="530" y="131.4355">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="530" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="631" y="145.4043">interval lists</text><rect fill="#555555" height="6" rx="2.5" ry="2.5" style="stroke:#555555;stroke-width:1.0;" width="979" x="11" y="224.1719"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="276" x="23" y="645.0571"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="256" x="33" y="668.0522">convert_IntervalListToBed_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="23" x2="299" y1="676.354" y2="676.354"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="221" x="33" y="692.4927">Convert IntervalList format intervals</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="33" y="706.4614">into BED format</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="216" x="53" y="754.2915"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="178" x="63" y="777.2866">call_gSNP_DeepVariant</text><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="269" y1="785.5884" y2="785.5884"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="196" x="63" y="801.7271">Call variants using DeepVariant</text><line style="stroke:#181818;stroke-width:1.5;" x1="518" x2="842" y1="279.2734" y2="279.2734"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="388" y="299.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="240" x="398" y="322.2686">run_HaplotypeCallerVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="388" x2="648" y1="330.5703" y2="330.5703"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="398" y="346.709">Generate VCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="398" y="360.6777">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="256" x="390" y="393.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="213" x="400" y="416.5029">run_MergeVcfs_Picard_VCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="390" x2="646" y1="424.8047" y2="424.8047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="236" x="400" y="440.9434">Merge raw variants into whole VCF file</text><polygon fill="#98FB98" points="406.5,477.604,629.5,477.604,639.5,494.5884,629.5,511.5728,406.5,511.5728" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="416.5" y="498.7427">Per-sample raw VCF + index files</text><rect fill="none" height="408.3281" style="stroke:#000000;stroke-width:1.5;" width="320" x="358" y="521.5728"/><path d="M504,521.5728 L504,530.8696 L494,540.8696 L358,540.8696 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="361" y="535.5679">Recalibrate Variants</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="368" y="557.8696"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="267" x="378" y="580.8647">run_VariantRecalibratorSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="368" x2="668" y1="589.1665" y2="589.1665"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="280" x="378" y="605.3052">Generate Variant Quality Score Recalibration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="378" y="619.2739">(VQSR) table for SNPs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="403" y="667.104"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="413" y="690.0991">run_ApplyVQSR_GATK_SNP</text><line style="stroke:#181818;stroke-width:1.0;" x1="403" x2="633" y1="698.4009" y2="698.4009"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="413" y="714.5396">Filter SNPs based on VQSR table</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="368" y="762.3696"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="280" x="378" y="785.3647">run_VariantRecalibratorINDEL_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="368" x2="668" y1="793.6665" y2="793.6665"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="199" x="378" y="809.8052">Generate VQSR table for INDELs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="243" x="396.5" y="857.6353"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="223" x="406.5" y="880.6304">run_ApplyVQSR_GATK_INDEL</text><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="639.5" y1="888.9321" y2="888.9321"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="406.5" y="905.0708">Filter INDELs based on VQSR table</text><polygon fill="#98FB98" points="422,949.9009,614,949.9009,624,973.8696,614,997.8384,422,997.8384" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="172" x="432" y="971.0396">SNP and INDEL recalibrated</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="432" y="985.0083">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="414.5" y="1017.8384"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="424.5" y="1040.8335">filter_gSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="414.5" x2="621.5" y1="1049.1353" y2="1049.1353"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="424.5" y="1065.2739">Filter ambiguous variants with</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="137" x="424.5" y="1079.2427">customized Perl script</text><polygon fill="#98FB98" points="443,1112.0728,593,1112.0728,603,1136.0415,593,1160.0103,443,1160.0103" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="453" y="1133.2114">Filtered germline</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="453" y="1147.1802">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="706" y="611.3228"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="252" x="716" y="634.3179">run_HaplotypeCallerGVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="706" x2="978" y1="642.6196" y2="642.6196"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="238" x="716" y="658.7583">Generate GVCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="716" y="672.7271">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="265" x="709.5" y="720.5571"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="225" x="719.5" y="743.5522">run_MergeVcfs_Picard_GVCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="709.5" x2="974.5" y1="751.854" y2="751.854"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="719.5" y="767.9927">Merge raw variants into whole GVCF file</text><polygon fill="#98FB98" points="739,815.8228,945,815.8228,955,832.8071,945,849.7915,739,849.7915" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="749" y="836.9614">Per-sample GVCF + index files</text><rect fill="#555555" height="6" rx="2.5" ry="2.5" style="stroke:#555555;stroke-width:1.0;" width="979" x="11" y="1180.0103"/><line style="stroke:#181818;stroke-width:1.0;" x1="446.5" x2="391.5" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="391.5" y1="62" y2="84"/><polygon fill="#181818" points="387.5,74,391.5,84,395.5,74,391.5,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="568.5" x2="623.5" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="62" y2="84"/><polygon fill="#181818" points="619.5,74,623.5,84,627.5,74,623.5,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="391.5" y1="186.1719" y2="204.1719"/><polygon fill="#181818" points="387.5,194.1719,391.5,204.1719,395.5,194.1719,391.5,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="158.2344" y2="204.1719"/><polygon fill="#181818" points="619.5,194.1719,623.5,204.1719,627.5,194.1719,623.5,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="623.5" y1="204.1719" y2="204.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="507.5" y1="30" y2="50"/><polygon fill="#181818" points="503.5,40,507.5,50,511.5,40,507.5,44" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="719.2915" y2="754.2915"/><polygon fill="#181818" points="157,744.2915,161,754.2915,165,744.2915,161,748.2915" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="373.5078" y2="393.5078"/><polygon fill="#181818" points="514,383.5078,518,393.5078,522,383.5078,518,387.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="453.7734" y2="477.604"/><polygon fill="#181818" points="514,467.604,518,477.604,522,467.604,518,471.604" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="632.104" y2="667.104"/><polygon fill="#181818" points="514,657.104,518,667.104,522,657.104,518,661.104" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="727.3696" y2="762.3696"/><polygon fill="#181818" points="514,752.3696,518,762.3696,522,752.3696,518,756.3696" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="822.6353" y2="857.6353"/><polygon fill="#181818" points="514,847.6353,518,857.6353,522,847.6353,518,851.6353" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="511.5728" y2="557.8696"/><polygon fill="#181818" points="514,547.8696,518,557.8696,522,547.8696,518,551.8696" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="917.9009" y2="949.9009"/><polygon fill="#181818" points="514,939.9009,518,949.9009,522,939.9009,518,943.9009" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="997.8384" y2="1017.8384"/><polygon fill="#181818" points="514,1007.8384,518,1017.8384,522,1007.8384,518,1011.8384" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="1092.0728" y2="1112.0728"/><polygon fill="#181818" points="514,1102.0728,518,1112.0728,522,1102.0728,518,1106.0728" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="685.5571" y2="720.5571"/><polygon fill="#181818" points="838,710.5571,842,720.5571,846,710.5571,842,714.5571" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="780.8228" y2="815.8228"/><polygon fill="#181818" points="838,805.8228,842,815.8228,846,805.8228,842,809.8228" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="280.7734" y2="299.2734"/><polygon fill="#181818" points="514,289.2734,518,299.2734,522,289.2734,518,293.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="280.7734" y2="611.3228"/><polygon fill="#181818" points="838,601.3228,842,611.3228,846,601.3228,842,605.3228" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="230.1719" y2="645.0571"/><polygon fill="#181818" points="157,635.0571,161,645.0571,165,635.0571,161,639.0571" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="25" lengthAdjust="spacing" textLength="155" x="165" y="456.104">DeepVariant</text><line style="stroke:#181818;stroke-width:1.0;" x1="668" x2="668" y1="230.1719" y2="279.2734"/><polygon fill="#181818" points="664,269.2734,668,279.2734,672,269.2734,668,273.2734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="25" lengthAdjust="spacing" textLength="199" x="672" y="263.3774">HaplotypeCaller</text><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="814.5571" y2="1180.0103"/><polygon fill="#181818" points="157,1170.0103,161,1180.0103,165,1170.0103,161,1174.0103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="507.5" y1="204.1719" y2="224.1719"/><polygon fill="#181818" points="503.5,214.1719,507.5,224.1719,511.5,214.1719,507.5,218.1719" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[103d7d64b890cac71b51892aa27fdbb1]
@startuml

skinparam ConditionEndStyle hline

start

if (Explicit intervals?) is (Yes) then
  :==run_SplitIntervals_GATK
  - - - -
  Split reference genome into up
  to **scatter_count** interval lists,
  without subdividing any of the
  input intervals;
else (No)
  :==run_SplitIntervals_GATK
  - - - -
  Split reference genome into
  **scatter_count** interval lists;
endif

fork
  -><size:25>DeepVariant</size>;
  :==convert_IntervalListToBed_GATK
  - - - -
  Convert IntervalList format intervals 
  into BED format;
  :==call_gSNP_DeepVariant
  - - - -
  Call variants using DeepVariant;
fork again
  -><size:25>HaplotypeCaller</size>;
  split

  :==run_HaplotypeCallerVCF_GATK
  - - - -
  Generate VCFs for each split interval
  using HaplotypeCaller;

  :==run_MergeVcfs_Picard_VCF
  - - - -
  Merge raw variants into whole VCF file;

  #palegreen:Per-sample raw VCF + index files>

  partition "Recalibrate Variants" {

  :==run_VariantRecalibratorSNP_GATK
  - - - -
  Generate Variant Quality Score Recalibration
  (VQSR) table for SNPs;

  :==run_ApplyVQSR_GATK_SNP
  - - - -
  Filter SNPs based on VQSR table;

  :==run_VariantRecalibratorINDEL_GATK
  - - - -
  Generate VQSR table for INDELs;

  :==run_ApplyVQSR_GATK_INDEL
  - - - -
  Filter INDELs based on VQSR table;

  }

  #palegreen:SNP and INDEL recalibrated
  variants + index files>

  :==filter_gSNP_GATK
  - - - -
  Filter ambiguous variants with
  customized Perl script;

  #palegreen:Filtered germline
  variants + index files>

  detach

  split again

  :==run_HaplotypeCallerGVCF_GATK
  - - - -
  Generate GVCFs for each split interval
  using HaplotypeCaller;

  :==run_MergeVcfs_Picard_GVCF
  - - - -
  Merge raw variants into whole GVCF file;

  #palegreen:Per-sample GVCF + index files>

  detach

  endsplit
end fork

@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>