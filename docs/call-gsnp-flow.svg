<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1193px" preserveAspectRatio="none" style="width:1001px;height:1193px;background:#FFFFFF;" version="1.1" viewBox="0 0 1001 1193" width="1001px" zoomAndPan="magnify"><defs/><g><ellipse cx="507.5" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><polygon fill="#F1F1F1" points="458.5,50,556.5,50,568.5,62,556.5,74,458.5,74,446.5,62,458.5,50" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="458.5" y="65.8081">Explicit intervals?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="425.5" y="59.4058">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="568.5" y="59.4058">No</text><rect fill="#F1F1F1" height="102.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="217" x="283" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="293" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="283" x2="500" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="293" y="131.4355">Split reference genome into up</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="13" x="293" y="145.4043">to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="310" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="411" y="145.4043">interval lists,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="293" y="159.373">without subdividing any of the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="89" x="293" y="173.3418">input intervals</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="520" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="530" y="106.9951">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="520" x2="727" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="530" y="131.4355">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="530" y="145.4043">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="631" y="145.4043">interval lists</text><rect fill="#555555" height="6" rx="2.5" ry="2.5" style="stroke:#555555;stroke-width:1.0;" width="979" x="11" y="224.1719"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="276" x="23" y="606.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="256" x="33" y="629.7373">convert_IntervalListToBed_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="23" x2="299" y1="638.0391" y2="638.0391"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="221" x="33" y="654.1777">Convert IntervalList format intervals</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="33" y="668.1465">into BED format</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="216" x="53" y="715.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="178" x="63" y="738.9717">call_gSNP_DeepVariant</text><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="269" y1="747.2734" y2="747.2734"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="196" x="63" y="763.4121">Call variants using DeepVariant</text><polygon fill="#98FB98" points="28.5,811.2422,293.5,811.2422,303.5,828.2266,293.5,845.2109,28.5,845.2109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="38.5" y="832.3809">Per-sample  VCF and GVCF + index files</text><line style="stroke:#181818;stroke-width:1.5;" x1="518" x2="842" y1="279.2734" y2="279.2734"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="388" y="299.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="240" x="398" y="322.2686">run_HaplotypeCallerVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="388" x2="648" y1="330.5703" y2="330.5703"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="398" y="346.709">Generate VCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="398" y="360.6777">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="256" x="390" y="393.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="213" x="400" y="416.5029">run_MergeVcfs_Picard_VCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="390" x2="646" y1="424.8047" y2="424.8047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="236" x="400" y="440.9434">Merge raw variants into whole VCF file</text><polygon fill="#98FB98" points="406.5,473.7734,629.5,473.7734,639.5,490.7578,629.5,507.7422,406.5,507.7422" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="416.5" y="494.9121">Per-sample raw VCF + index files</text><rect fill="none" height="408.3281" style="stroke:#000000;stroke-width:1.5;" width="320" x="358" y="517.7422"/><path d="M504,517.7422 L504,527.0391 L494,537.0391 L358,537.0391 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="361" y="531.7373">Recalibrate Variants</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="368" y="554.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="267" x="378" y="577.0342">run_VariantRecalibratorSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="368" x2="668" y1="585.3359" y2="585.3359"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="280" x="378" y="601.4746">Generate Variant Quality Score Recalibration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="378" y="615.4434">(VQSR) table for SNPs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="403" y="663.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="413" y="686.2686">run_ApplyVQSR_GATK_SNP</text><line style="stroke:#181818;stroke-width:1.0;" x1="403" x2="633" y1="694.5703" y2="694.5703"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="413" y="710.709">Filter SNPs based on VQSR table</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="368" y="758.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="280" x="378" y="781.5342">run_VariantRecalibratorINDEL_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="368" x2="668" y1="789.8359" y2="789.8359"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="199" x="378" y="805.9746">Generate VQSR table for INDELs</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="243" x="396.5" y="853.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="223" x="406.5" y="876.7998">run_ApplyVQSR_GATK_INDEL</text><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="639.5" y1="885.1016" y2="885.1016"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="406.5" y="901.2402">Filter INDELs based on VQSR table</text><polygon fill="#98FB98" points="422,946.0703,614,946.0703,624,970.0391,614,994.0078,422,994.0078" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="172" x="432" y="967.209">SNP and INDEL recalibrated</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="432" y="981.1777">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="414.5" y="1014.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="424.5" y="1037.0029">filter_gSNP_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="414.5" x2="621.5" y1="1045.3047" y2="1045.3047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="424.5" y="1061.4434">Filter ambiguous variants with</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="137" x="424.5" y="1075.4121">customized Perl script</text><polygon fill="#98FB98" points="443,1108.2422,593,1108.2422,603,1132.2109,593,1156.1797,443,1156.1797" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="453" y="1129.3809">Filtered germline</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="453" y="1143.3496">variants + index files</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="706" y="607.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="252" x="716" y="630.4873">run_HaplotypeCallerGVCF_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="706" x2="978" y1="638.7891" y2="638.7891"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="238" x="716" y="654.9277">Generate GVCFs for each split interval</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136" x="716" y="668.8965">using HaplotypeCaller</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="265" x="709.5" y="716.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="225" x="719.5" y="739.7217">run_MergeVcfs_Picard_GVCF</text><line style="stroke:#181818;stroke-width:1.0;" x1="709.5" x2="974.5" y1="748.0234" y2="748.0234"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="719.5" y="764.1621">Merge raw variants into whole GVCF file</text><polygon fill="#98FB98" points="739,811.9922,945,811.9922,955,828.9766,945,845.9609,739,845.9609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="749" y="833.1309">Per-sample GVCF + index files</text><rect fill="#555555" height="6" rx="2.5" ry="2.5" style="stroke:#555555;stroke-width:1.0;" width="979" x="11" y="1176.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="446.5" x2="391.5" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="391.5" y1="62" y2="84"/><polygon fill="#181818" points="387.5,74,391.5,84,395.5,74,391.5,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="568.5" x2="623.5" y1="62" y2="62"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="62" y2="84"/><polygon fill="#181818" points="619.5,74,623.5,84,627.5,74,623.5,78" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="391.5" y1="186.1719" y2="204.1719"/><polygon fill="#181818" points="387.5,194.1719,391.5,204.1719,395.5,194.1719,391.5,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="158.2344" y2="204.1719"/><polygon fill="#181818" points="619.5,194.1719,623.5,204.1719,627.5,194.1719,623.5,198.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="623.5" y1="204.1719" y2="204.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="507.5" y1="30" y2="50"/><polygon fill="#181818" points="503.5,40,507.5,50,511.5,40,507.5,44" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="680.9766" y2="715.9766"/><polygon fill="#181818" points="157,705.9766,161,715.9766,165,705.9766,161,709.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="776.2422" y2="811.2422"/><polygon fill="#181818" points="157,801.2422,161,811.2422,165,801.2422,161,805.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="373.5078" y2="393.5078"/><polygon fill="#181818" points="514,383.5078,518,393.5078,522,383.5078,518,387.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="453.7734" y2="473.7734"/><polygon fill="#181818" points="514,463.7734,518,473.7734,522,463.7734,518,467.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="628.2734" y2="663.2734"/><polygon fill="#181818" points="514,653.2734,518,663.2734,522,653.2734,518,657.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="723.5391" y2="758.5391"/><polygon fill="#181818" points="514,748.5391,518,758.5391,522,748.5391,518,752.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="818.8047" y2="853.8047"/><polygon fill="#181818" points="514,843.8047,518,853.8047,522,843.8047,518,847.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="507.7422" y2="554.0391"/><polygon fill="#181818" points="514,544.0391,518,554.0391,522,544.0391,518,548.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="914.0703" y2="946.0703"/><polygon fill="#181818" points="514,936.0703,518,946.0703,522,936.0703,518,940.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="994.0078" y2="1014.0078"/><polygon fill="#181818" points="514,1004.0078,518,1014.0078,522,1004.0078,518,1008.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="1088.2422" y2="1108.2422"/><polygon fill="#181818" points="514,1098.2422,518,1108.2422,522,1098.2422,518,1102.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="681.7266" y2="716.7266"/><polygon fill="#181818" points="838,706.7266,842,716.7266,846,706.7266,842,710.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="776.9922" y2="811.9922"/><polygon fill="#181818" points="838,801.9922,842,811.9922,846,801.9922,842,805.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="518" x2="518" y1="280.7734" y2="299.2734"/><polygon fill="#181818" points="514,289.2734,518,299.2734,522,289.2734,518,293.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="842" y1="280.7734" y2="607.4922"/><polygon fill="#181818" points="838,597.4922,842,607.4922,846,597.4922,842,601.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="230.1719" y2="606.7422"/><polygon fill="#181818" points="157,596.7422,161,606.7422,165,596.7422,161,600.7422" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="25" lengthAdjust="spacing" textLength="155" x="165" y="438.8618">DeepVariant</text><line style="stroke:#181818;stroke-width:1.0;" x1="668" x2="668" y1="230.1719" y2="279.2734"/><polygon fill="#181818" points="664,269.2734,668,279.2734,672,269.2734,668,273.2734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="25" lengthAdjust="spacing" textLength="199" x="672" y="263.3774">HaplotypeCaller</text><line style="stroke:#181818;stroke-width:1.0;" x1="161" x2="161" y1="845.2109" y2="1176.1797"/><polygon fill="#181818" points="157,1166.1797,161,1176.1797,165,1166.1797,161,1170.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="507.5" y1="204.1719" y2="224.1719"/><polygon fill="#181818" points="503.5,214.1719,507.5,224.1719,511.5,214.1719,507.5,218.1719" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[e8c2dfac380d34bb1db81d94bb5b04a3]
@startuml

skinparam ConditionEndStyle hline

start

if (Explicit intervals?) is (Yes) then
  :==run_SplitIntervals_GATK
  - - - -
  Split reference genome into up
  to **scatter_count** interval lists,
  without subdividing any of the
  input intervals;
else (No)
  :==run_SplitIntervals_GATK
  - - - -
  Split reference genome into
  **scatter_count** interval lists;
endif

fork
  -><size:25>DeepVariant</size>;
  :==convert_IntervalListToBed_GATK
  - - - -
  Convert IntervalList format intervals 
  into BED format;
  :==call_gSNP_DeepVariant
  - - - -
  Call variants using DeepVariant;

  #palegreen:Per-sample  VCF and GVCF + index files>
fork again
  -><size:25>HaplotypeCaller</size>;
  split

  :==run_HaplotypeCallerVCF_GATK
  - - - -
  Generate VCFs for each split interval
  using HaplotypeCaller;

  :==run_MergeVcfs_Picard_VCF
  - - - -
  Merge raw variants into whole VCF file;

  #palegreen:Per-sample raw VCF + index files>

  partition "Recalibrate Variants" {

  :==run_VariantRecalibratorSNP_GATK
  - - - -
  Generate Variant Quality Score Recalibration
  (VQSR) table for SNPs;

  :==run_ApplyVQSR_GATK_SNP
  - - - -
  Filter SNPs based on VQSR table;

  :==run_VariantRecalibratorINDEL_GATK
  - - - -
  Generate VQSR table for INDELs;

  :==run_ApplyVQSR_GATK_INDEL
  - - - -
  Filter INDELs based on VQSR table;

  }

  #palegreen:SNP and INDEL recalibrated
  variants + index files>

  :==filter_gSNP_GATK
  - - - -
  Filter ambiguous variants with
  customized Perl script;

  #palegreen:Filtered germline
  variants + index files>

  detach

  split again

  :==run_HaplotypeCallerGVCF_GATK
  - - - -
  Generate GVCFs for each split interval
  using HaplotypeCaller;

  :==run_MergeVcfs_Picard_GVCF
  - - - -
  Merge raw variants into whole GVCF file;

  #palegreen:Per-sample GVCF + index files>

  detach

  endsplit
end fork

@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>